---
title: 转录组分析的正确姿势(第三版)
author: ct
layout: post
categories:
  - Bioinfo
tags:
  - Bioinfo
---

转录组分析是目前应用最广的高通量测序分析技术之一。常见设计是不同样品之间比较，寻找差异基因、标志基因、[协同变化基因](https://mp.weixin.qq.com/s/PMb2xwADvnMwaipyFXdtzQ)、差异剪接和新转录本，并进行[结果可视化](https://mp.weixin.qq.com/s/bsvB1k17Izom2ldgdwXrdg)、[功能注释](https://mp.weixin.qq.com/s/Zz6d8NyyD0zOv7hD822SAQ)和[网络分析](https://mp.weixin.qq.com/s/rK5SolI0xGisvBCIcb448A)等。

转录组的测序分析也相对成熟，从RNA提取、构建文库、上机测序再到结果解析既可以自己完成，又可以在专业公司进行。

概括来看转录组的分析流程比较简单，`序列比对`-`转录本拼接 (可选)`-`表达定量`-`差异基因`-`功能富集`-`定制分析`。整个环节清晰流畅，可以作为最开始接触高通量测序学习最合适的技术之一。

但重点和难点在于理解这些过程都是怎么做的，有什么需要注意的，结果怎么解读，后续分析怎么做。这些只有自己动手操作过，才可能有理解。而理解了一个，再去做其它类型分析，也会轻松很多。

实验设计这块重要的是对照和至少`3`个生物学重复，并选择合适的测序通量。`ENCODE`要求重复之间的`Spearman correlation`值大于`0.9` (遗传背景不一致的生物重复相关系数要大于`0.8`)。定量基因表达和评估转录图谱相似性只需要中等测序深度；而研究新转录本和可变剪接则需要更深的测序；一般来讲长RNA-seq文库测序深度满足`可用reads`在`20-30 million` (如果测PE150，换算成碱基数为6G-9G)。

另外一个需要注意的是测序的批次效应，保证自己的样品同时处理、RNA同时提取、同时构建文库和上机测序。这些环节虽然不能总受我们控制，但记录下对应的操作时间和批次，最后在绘制表达图谱时与实验相关参数进行`关联展示` (利用我们介绍的[热图简化](https://mp.weixin.qq.com/s/_9LKs6t6rcjzokF_0gneSA), 或者使用我们开发的在[线绘图工具](https://mp.weixin.qq.com/s/MnM_MyosBdEvKV0W018KeA)直接绘制)，从而保证结果没有受到试验中处理批次的影响。`ENCODE`计划有一篇文章在比较人和小鼠不同组织的表达谱相似度时得到的结果是样品按物种而非组织聚在一起，这与之前认为的发育通路的保守性不符。后来发现是测序批次捣的鬼，做了批次效应矫正后，表达图谱按组织而非物种聚在一起了。

![](http://blog.genesino.com/images/train/Bacth_effect3.png)

测序环节通常不需要自己操作，测序公司都很成熟，但[测序的原理](http://mp.weixin.qq.com/s/SS9YBSpgUoU9gI86u-0ATg)需要知道。这会影响到后续分析时参数的选择，比如知道**什么是插入片段大小**，**什么是链特异性测序**，什么情况会有**接头**序列，双端测序如何测等。

获得数据后，就涉及到数据的传输和质量评估(也包括如何从公共数据库下载数据)和文件格式的转换。[FASTQ格式解释和质量评估](http://mp.weixin.qq.com/s/tDMih7ISLJcL4F4sWBq3Vw)中有些提及。质量评估的意义在于从测序质量角度评价建库和测序的成功与否，指导接头和低质量碱基的去除。这一步参数控制的严格与否对后续的比对会有影响，同时也会受到后续分析选择的工具的影响。对[Linux系统](http://mp.weixin.qq.com/s/8wD14FXt7fLDo1BjJyT0ew)一定程度的了解，是进行这些工作的基础。

[39个转录组分析工具，120种组合评估(转录组分析工具哪家强)](https://mp.weixin.qq.com/s/NUEi6oRFL7B3f1FpCD4Xug)中讲述了如何选择、评估合适的比对工具，序列拼装工具，定量工具和差异分析工具。值得我们在进入正式的分析之前，仔细阅读。另外类似的评估文章，还有几篇，都可以一并读一下，这样在后期分析时对工具的选择和使用才更得心应手。

工具比较类文章一般只告诉你做了什么，不告诉你这么做的原因是什么，而且每一步细分开来又有很多小细节需要注意，比如在比对环节就会涉及到：不同的样本如何选择合适的[基因组和注释文件](http://mp.weixin.qq.com/s/2OoXy4f1t0hE8OUqsAt1kw)，什么样的软件支持Junction reads的比对，什么样的**比对率**是合适的，比对质量怎样，测序中RNA有无降解或选择偏好性，测序饱和度如何等。

这些可能都不会体现在最终的结果中，但都是确保后期结果可靠性所必须要做的事情。2002年诺贝尔奖得主`Sydney Brenner`曾对数据分析做过提醒`Garbage in, Garbage out`。软件是死的，提供了格式正确的输入，就可以得到输出，但输出正确与否，就得靠人的经验来判断了。

在后面的差异基因鉴定阶段，还存在把`FPKM`值转换为整数再提交给`DESeq2`做分析的，**软件不报错，但结果不对**。或者能顺着教程运行`DEseq2`分析，但换成自己的数据就不知道如何下手的。这些问题都需要在实践过程中持续不断的试错、阅读更多的文章和教程来步步矫正。这当然是一个耗时耗力的过程，那么有没有一个更好的方式呢？

生信宝典团队经过紧张的筹备，决定推出一系列的针对生信学习和高通量分析的兴趣小组(在[生信学习系列教程](http://mp.weixin.qq.com/s/VguRtaGpEcaNzmZEi48gLg)的基础上进一步拓展和深入)，跟大家一起去走过这段历程。我们的口号是`易生信，毕生缘`，希望能通过短暂高强度的训练快速推进大家在生信分析领域的进展。

之前的培训重点都在前面的流程分析，这次做了调整，流程分析整理一个清晰的输入、输出框架，包装好的流程脚本和参数注意，快速实战操作从源头。**重点调整到后续的定制分析和绘图**，涉及常见GO分析、单细胞转录组的聚类分析、配对样品和时间序列样品的GSEA富集分析、结合motif预测和转录因子ChIP的调控网络分析、定制化图形绘制、Cytoscape进行富集分析、调控网络、通路的可视化，目标基因筛选和可视化, WGCNA加权共表达网络分析。

每部分都提供清晰的思维导图方便理解输入、输出、命令、参数和注意事项。

但生信学习是个缓慢的过程，需要教、学、练、改不断的循环。我们希望能通过系列课程，再加上`四段式`培训模式`集中讲解实战(2天)-自行练习(5天)-再讲解答疑考核(2天)-后续视频观摩和群内讨论`跟大家一起探索如何尽可能快的学会生信，学到可以自己做，有问题自己可以解决的程度。<mark>点击阅读原文可查看详细信息</mark>。

![](http://blog.genesino.com/images/train/transcriptome_train3.png)

再强调下，培训时间是2018年5月12日、13日、19日、20日。培训地点是北京鼓楼，<mark>点击阅读原文可查看详细信息</mark>。

欢迎大家咨询、报名和提出建议 (报名网址: <http://www.ehbio.com/Training>)。

生信宝典: [http://mp.weixin.qq.com/s/d1KCETQZ88yaOLGwAtpWYg](http://mp.weixin.qq.com/s/d1KCETQZ88yaOLGwAtpWYg)



## 生信宝典，生物信息学习系列教程，转录组，宏基因组，外显子组，R作图，Python学习，Cytoscape视频教程

[http://mp.weixin.qq.com/s/d1KCETQZ88yaOLGwAtpWYg](http://mp.weixin.qq.com/s/d1KCETQZ88yaOLGwAtpWYg)

## 生信宝典，最好的生物信息培训课程，培训课程资料

[www.ehbio.com/Training](www.ehbio.com/Training)
